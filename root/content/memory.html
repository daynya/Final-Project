---
@{main}
<h1 class="project-page-title">Memory Game</h1>
<img src="img/memory-main.png" class="design-main-img border" alt="Memory game">
<h4 class="project-subtitle">Building of JavaScript Memory Game</h4>
<p>
    Using HTML, CSS and JavaScript, I built a two player memory game. The game rules follow:
</p>
<ul>
    <li>Each player takes a turn and turns over two cards, one at a time.</li>
    <li>If the cards are not a match, they get turned back over.</li>
    <li>If the cards are a match, they stay flipped.</li>
    <li>If you get a match, you get another turn.</li>
    <li>The player with the most matches wins.</li>
</ul>
<img src="img/memory-match.png" class="design-main-img border" alt="Memory Game">
<h4 class="project-subtitle">How I built it</h4>
<p>
    To establish a structure for the game, I started with a standard HTML setup. 
    I included a scoreboard and a gameboard.
</p>
<pre>
    <code class="language-html">
&lt;div class=&quot;card&quot; data-icon=&quot;cat&quot;&gt;
    &lt;i class=&quot;fas fa-cat fa-5x card-front&quot;&gt;&lt;/i&gt;
    &lt;img class=&quot;card-back&quot; src=&quot;img/question.png&quot; alt=&quot;question mark&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;card&quot; data-icon=&quot;cat&quot;&gt;
    &lt;i class=&quot;fas fa-cat fa-5x card-front&quot;&gt;&lt;/i&gt;
    &lt;img class=&quot;card-back&quot; src=&quot;img/question.png&quot; alt=&quot;question mark&quot;&gt;
&lt;/div&gt;
    </code>
</pre>
<p>
    I created a grid of divs which serve as the cards, a pair of them is shown in the code
    above. Each card has an image on the back, which is the side you see at the game 
    start. The other side of each card has an icon. There are currently 16 cards total, and 
    8 unique icons for 8 matches. That's about it for the HTML!
</p>
<h4 class="project-subtitle">The Challenges</h4>
<p>
    This game serves up a handful of challenges, and here is how I tackled some of those.
</p>
<h6>Deal the cards</h6>
<p>
    To begin the game, the cards must be shuffled. Below is my <span class="code">shuffleCards</span> 
    function.
</p>
<pre>
    <code class="language-javascript">
function shuffleCards() {
    cards.forEach(card => {
        let randomPos = Math.floor(Math.random() * 16);
        card.style.order = randomPos;
    });
}
    </code>
</pre>
<p>
    To shuffle the cards, I created a function that generates a random number between 
    1-16. First, it goes through each card in the <span class="code">cards</span> array 
    using <span class="code">forEach</span>, and assigns it a random number. The random
    number is generated by first taking <span class="code">Math.random</span> and multiplying
    it by our number of cards (16) to get a random number between 1 and 16. Then we use
    <span class="code">Math.floor</span> to round this result down to an integer, which 
    then gets applied to the <span class="code">order</span> style on the card divs to change their displayed 
    order on screen. This is called upon the start of a new game.
</p>
<h6 class="project-subtitle">Flip the cards over when clicked</h6>
<p>
    The next task is to make the cards display properly when clicked, and also to assign 
    a "first" or "second" status to them to allow the match and win checks to take place.
</p>
<pre>
    <code class="language-javascript">
function flipCard() {
    if (lockBoard) return;

    if (this === firstCard) return; 

    this.classList.add('flip');

    if (!secondFlip) {
        secondFlip = true;
        firstCard = this;

    } else {
        secondCard = this;
        checkForMatch();
        checkForWin();
    }
}
    </code>
</pre>
<p>
    In the <span class="code">flipCard</span> function shown above, there are several things 
    happening. First, we make sure that the cards aren't clickable when they're flipping back
    over. Secondly, we make sure that if the player clicks the same card a second time within
    a turn, nothing happens. When a card is clicked, it is has a <span class="code">flip</span>
    class added to it. Each card div has both an image (shared with all other card backs), and
    an icon. You can see both in the HTML snippet included above. The icon is not visible upon
    loading the game, but when the <span class="code">flip</span> class is added, it will add
    a rotation animation, and display the icon on the underside of the card. If the card is 
    the first one clicked in a turn, it is assigned a <span class="code">firstCard</span> class,
    otherwise, we know it's the <span class="code">secondCard</span>. Once a second card is 
    clicked, <span class="code">flipCard</span> calls<span class="code">checkForMatch</span>
    (to check for a match) and <span class="code">checkForWin</span> (to check for a winner).
</p>
<h6 class="project-subtitle">Test for matched cards</h6>
<p>
    The next task is to see if the cards match.
</p>
<pre>
    <code class="language-javascript">
function checkForMatch() {
    let isMatch = firstCard.dataset.icon === secondCard.dataset.icon;

    if (isMatch) {
        updateMatchColor();
        disableCards(); 
        updateScore();

        setTimeout(() => {
            updateScoreboard();
        }, 500);
    } else {
        unflipCards();

        setTimeout(() => {
            nextPlayer();
        }, 1500);
    }
}
</code>
</pre>
<p>
    When the <span class="code">flip</span> class is added to two cards, <span class="code">
    checkForMatch</span> is the function that tests to see if the <span class="code">dataset</span>
    on each matches the other. If it does, then the paired match stays flipped and turns the 
    color of the player to whom it is awarded. Those cards then get disabled from further game
    play, and the score is updated. If the cards are not a match, the <span class="code">flip</span>
    class is removed from them, and they are turned back over to remain in play. The first 
    <span class="code">setTimeout</span> here allows the scoreboard to be updated before
    highlighting the next player. The second timeout is to allow the cards to finish flipping
    back over when it's not a match before changing players.
</p>
<h6 class="project-subtitle">Alternate turns</h6>
<p>
    When a match is not made, then it's the other player's turn.
</p>
<pre>
    <code class="language-html">
&lt;div id=&quot;scoreboard&quot; class=&quot;row player-panel&quot;&gt;
&lt;div class=&quot;col player-0-panel active&quot;&gt;
    &lt;div class=&quot;player-name&quot; id=&quot;player-0&quot;&gt;BLUE PLAYER&lt;/div&gt;
    &lt;div class=&quot;player-score&quot; id=&quot;score-0&quot;&gt;0&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;col&quot;&gt;
    &lt;button id=&quot;new-game&quot;&gt;NEW GAME&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;col player-1-panel&quot;&gt;
    &lt;div class=&quot;player-name&quot; id=&quot;player-1&quot;&gt;RED PLAYER&lt;/div&gt;
    &lt;div class=&quot;player-score&quot; id=&quot;score-1&quot;&gt;0&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    </code>
</pre>
<p>
    In my HTML file, I included a div for each player. One of the player divs has a class
    of <span class="code">active</span> added by default.
</p>
<pre>
    <code class="language-javascript">
function nextPlayer() {
    if (activePlayer === 0) {
        activePlayer = 1;
        document.querySelector('.player-0-panel').classList.toggle('active');
        document.querySelector('.player-1-panel').classList.toggle('active');
    } else {
        activePlayer = 0;
        document.querySelector('.player-0-panel').classList.toggle('active');
        document.querySelector('.player-1-panel').classList.toggle('active');
    }
}
    </code>
</pre>
<p>
    If the player has made a match, they get another turn. This is done by leaving them in
    active status with the <span class="code">active</span> class. If they do not get a 
    match, then the <span class="code">nextPlayer</span> function is called, and the <span class="code">
    active</span> class toggles to the other player. The active player is highlighted on 
    the scoreboard at top of the game.
</p>
<h6 class="project-subtitle">Calculate a winner</h6>
<p>When the cards have all been flipped over, a winner must be declared.</p>
<pre>
    <code class="language-javascript">
function checkForWin() {
    if (scores[0] + scores[1] == 8) {
        // The Timeout function here is to allow the cards to finish
        // flipping and updating color before showing the winner.
        setTimeout(() => {
            updateWinner();
        }, 1000);
    }
}

function updateWinner() {
    if (scores[0] > scores[1]) {
        document.getElementById('scoreboard').style.display = 'none';
        document.getElementById('winner-alert').style.display = 'block';
        document.getElementById('winner-alert').style.color = '#044497';
        document.getElementById('winner-alert').textContent = 'BLUE WINS!';
    } else if (scores[0] < scores[1]) {
        document.getElementById('scoreboard').style.display = 'none';
        document.getElementById('winner-alert').style.display = 'block';
        document.getElementById('winner-alert').style.color = 'red';
        document.getElementById('winner-alert').textContent = 'RED WINS!';
    } else {
        document.getElementById('scoreboard').style.display = 'none';
        document.getElementById('winner-alert').style.display = 'block';
        document.getElementById('winner-alert').textContent = 'TIE GAME, TRY AGAIN!';
    }

    setTimeout(() => {
        resetGame();
    }, 1500);
}
    </code>
</pre>
<p>
    Each time there is a match, the <span class="code">checkForWin</span> function is called.
    After all 8 pairs of cards have been matched, then a winner is calculated. Whichever player
    has a greater number of matches wins. The timeout shown in <span class="code">checkForWin</span>
    allows the last card to finish flipping over and being assigned its color before declaring
    the winner. When the <span class="code">updateWinner</span> function runs, it changes the
    style and text content of the winning player's scoreboard to show who won, or that it's a
    tie. The timeout there is to allow this message to display briefly before resetting the 
    board for a new game.
</p>
<h6 class="project-subtitle">Start a new game</h6>
<p>
    The players need an ability to start a new game, or to have one load automatically when
    their current game is complete.
</p>
<pre>
    <code class="language-javascript">
function resetGame() {
    secondFlip = false;
    lockBoard = false;
    firstCard = null;
    secondCard = null;
    scores = [0,0];
    activePlayer = 0;

    cards.forEach(card => card.addEventListener('click', flipCard));
    cards.forEach(card => card.classList.remove('flip'));
    
    cards.forEach(card => card.classList.remove('blue'));
    cards.forEach(card => card.classList.remove('red'));

    lockBoard = true;

    setTimeout(() => {
        shuffleCards();
        lockBoard = false;
    }, 1000);

    document.getElementById('score-0').textContent = '0';
    document.getElementById('score-1').textContent = '0';
    document.getElementById('scoreboard').style.display = '';
    document.getElementById('winner-alert').style.display = 'none';
}
    </code>
</pre>
<p>
    When a player has won, or the "New Game" button has been clicked, the gameboard is reset.
    The scores are reset, and the added classes are removed from all cards. The timeout here
    allows the cards to finish flipping over before shuffling begins.
</p>
<h6 class="project-subtitle">Timeouts</h6>
<p>
    In order to make the game play more smoothly, I did have to add a timer to a lot of the
    functions included, as you can see above. I felt this was one of the fun challenges. 
    Adding these in definitely improved the user experience of the game. Many were issues 
    that I never anticpated having until I ran into them during game play. Some of the timers
    added are: 
    <ul>
        <li>Displaying the cards for a second before flipping them back over if they aren't a match.</li>
        <li>Allow the cards to finish flipping back over before changing players.</li>
        <li>Allow the second card to diplay before flipping back over.</li>
        <li>Allow the scoreboard to update before changing the display around the active player.</li>
        <li>Allow the cards to finish shuffling before being clickable.</li>
        <li>Allow the card to display the icon when clicked before assigning it a color if it's a match.</li>
        <li>Allow the card to finish updating match color before showing the winner.</li>
    </ul>
</p>
<p>
    This was a fun exercise for me. I ran into some roadblocks that were a little
    tricky, but it gave me a good opportunity to learn some new tricks.
</p>
<h3><a href="memory-game/" class="link">Click here to play the game!</a></h3>
---
